/*! xLabsAnalytics 17-08-2015 */
var xa=function(){function a(a){for(var b=[a],c=0,d=0;d<b.length;d++)switch(typeof b[d]){case"boolean":c+=4;break;case"number":c+=8;break;case"string":c+=2*b[d].length;break;case"object":if("[object Array]"!=Object.prototype.toString.call(b[d]))for(var e in b[d])c+=2*e.length;for(var e in b[d]){for(var f=!1,g=0;g<b.length;g++)if(b[g]===b[d][e]){f=!0;break}f||b.push(b[d][e])}}return c}SERVER_HOST="http://api.pinkpineapple.me",FRONT_END_HOST="http://";var b=function(){function a(a,b){if(!e[a]){e[a]={};for(var c=0;c<a.length;c++)e[a][a[c]]=c}return e[a][b]}var b=String.fromCharCode,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",e={},f={compressToBase64:function(a){if(null==a)return"";var b=f._compress(a,6,function(a){return c.charAt(a)});switch(b.length%4){default:case 0:return b;case 1:return b+"===";case 2:return b+"==";case 3:return b+"="}},decompressFromBase64:function(b){return null==b?"":""==b?null:f._decompress(b.length,32,function(d){return a(c,b.charAt(d))})},compressToUTF16:function(a){return null==a?"":f._compress(a,15,function(a){return b(a+32)})+" "},decompressFromUTF16:function(a){return null==a?"":""==a?null:f._decompress(a.length,16384,function(b){return a.charCodeAt(b)-32})},compressToUint8Array:function(a){for(var b=f.compress(a),c=new Uint8Array(2*b.length),d=0,e=b.length;e>d;d++){var g=b.charCodeAt(d);c[2*d]=g>>>8,c[2*d+1]=g%256}return c},decompressFromUint8Array:function(a){if(null===a||void 0===a)return f.decompress(a);for(var c=new Array(a.length/2),d=0,e=c.length;e>d;d++)c[d]=256*a[2*d]+a[2*d+1];var g=[];return c.forEach(function(a){g.push(b(a))}),f.decompress(g.join(""))},compressToEncodedURIComponent:function(a){return null==a?"":f._compress(a,6,function(a){return d.charAt(a)})},decompressFromEncodedURIComponent:function(b){return null==b?"":""==b?null:(b=b.replace(/ /g,"+"),f._decompress(b.length,32,function(c){return a(d,b.charAt(c))}))},compress:function(a){return f._compress(a,16,function(a){return b(a)})},_compress:function(a,b,c){if(null==a)return"";var d,e,f,g={},h={},i="",j="",k="",l=2,m=3,n=2,o=[],p=0,q=0;for(f=0;f<a.length;f+=1)if(i=a[f],Object.prototype.hasOwnProperty.call(g,i)||(g[i]=m++,h[i]=!0),j=k+i,Object.prototype.hasOwnProperty.call(g,j))k=j;else{if(Object.prototype.hasOwnProperty.call(h,k)){if(k.charCodeAt(0)<256){for(d=0;n>d;d++)p<<=1,q==b-1?(q=0,o.push(c(p)),p=0):q++;for(e=k.charCodeAt(0),d=0;8>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1}else{for(e=1,d=0;n>d;d++)p=p<<1|e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e=0;for(e=k.charCodeAt(0),d=0;16>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1}l--,0==l&&(l=Math.pow(2,n),n++),delete h[k]}else for(e=g[k],d=0;n>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1;l--,0==l&&(l=Math.pow(2,n),n++),g[j]=m++,k=String(i)}if(""!==k){if(Object.prototype.hasOwnProperty.call(h,k)){if(k.charCodeAt(0)<256){for(d=0;n>d;d++)p<<=1,q==b-1?(q=0,o.push(c(p)),p=0):q++;for(e=k.charCodeAt(0),d=0;8>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1}else{for(e=1,d=0;n>d;d++)p=p<<1|e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e=0;for(e=k.charCodeAt(0),d=0;16>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1}l--,0==l&&(l=Math.pow(2,n),n++),delete h[k]}else for(e=g[k],d=0;n>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1;l--,0==l&&(l=Math.pow(2,n),n++)}for(e=2,d=0;n>d;d++)p=p<<1|1&e,q==b-1?(q=0,o.push(c(p)),p=0):q++,e>>=1;for(;;){if(p<<=1,q==b-1){o.push(c(p));break}q++}return o.join("")},decompress:function(a){return null==a?"":""==a?null:f._decompress(a.length,32768,function(b){return a.charCodeAt(b)})},_decompress:function(a,c,d){var e,f,g,h,i,j,k,l,m=[],n=4,o=4,p=3,q="",r=[],s={val:d(0),position:c,index:1};for(f=0;3>f;f+=1)m[f]=f;for(h=0,j=Math.pow(2,2),k=1;k!=j;)i=s.val&s.position,s.position>>=1,0==s.position&&(s.position=c,s.val=d(s.index++)),h|=(i>0?1:0)*k,k<<=1;switch(e=h){case 0:for(h=0,j=Math.pow(2,8),k=1;k!=j;)i=s.val&s.position,s.position>>=1,0==s.position&&(s.position=c,s.val=d(s.index++)),h|=(i>0?1:0)*k,k<<=1;l=b(h);break;case 1:for(h=0,j=Math.pow(2,16),k=1;k!=j;)i=s.val&s.position,s.position>>=1,0==s.position&&(s.position=c,s.val=d(s.index++)),h|=(i>0?1:0)*k,k<<=1;l=b(h);break;case 2:return""}for(m[3]=l,g=l,r.push(l);;){if(s.index>a)return"";for(h=0,j=Math.pow(2,p),k=1;k!=j;)i=s.val&s.position,s.position>>=1,0==s.position&&(s.position=c,s.val=d(s.index++)),h|=(i>0?1:0)*k,k<<=1;switch(l=h){case 0:for(h=0,j=Math.pow(2,8),k=1;k!=j;)i=s.val&s.position,s.position>>=1,0==s.position&&(s.position=c,s.val=d(s.index++)),h|=(i>0?1:0)*k,k<<=1;m[o++]=b(h),l=o-1,n--;break;case 1:for(h=0,j=Math.pow(2,16),k=1;k!=j;)i=s.val&s.position,s.position>>=1,0==s.position&&(s.position=c,s.val=d(s.index++)),h|=(i>0?1:0)*k,k<<=1;m[o++]=b(h),l=o-1,n--;break;case 2:return r.join("")}if(0==n&&(n=Math.pow(2,p),p++),m[l])q=m[l];else{if(l!==o)return null;q=g+g[0]}r.push(q),m[o++]=g+q[0],n--,g=q,0==n&&(n=Math.pow(2,p),p++)}}};return f}();"function"==typeof define&&define.amd?define(function(){return b}):"undefined"!=typeof module&&null!=module&&(module.exports=b);var c={mouseDownCallback:null,mouseMoveCallback:null,mouseUpCallback:null,xMouseScreen:0,yMouseScreen:0,bMouseDown:!1,xMouseScreenDown:0,yMouseScreenDown:0,tMouseScreenDown:0,xMouseScreenUp:0,yMouseScreenUp:0,tMouseScreenUp:0,addMouseListeners:function(){window.addEventListener("mousemove",function(a){c.onMouseMove(a)},!1),window.addEventListener("mousedown",function(a){c.onMouseDown(a)},!1),window.addEventListener("mouseup",function(a){c.onMouseUp(a)},!1)},getMouseScreenX:function(a){return null==d.config?a.screenX:"1"==d.getConfig("browser.mouse.absScreenCoordinates")?a.screenX:a.screenX+window.screenX},getMouseScreenY:function(a){return null==d.config?a.screenY:"1"==d.getConfig("browser.mouse.absScreenCoordinates")?a.screenY:a.screenY+window.screenY},onMouseMove:function(a){c.xMouseScreen=c.getMouseScreenX(a),c.yMouseScreen=c.getMouseScreenY(a),null!=c.mouseMoveCallback&&c.mouseMoveCallback()},onMouseDown:function(a){c.bMouseDown=!0;var b=c.getMouseScreenX(a),e=c.getMouseScreenY(a);c.xMouseScreenDown=b,c.yMouseScreenDown=e,c.tMouseScreenDown=d.getTimestamp(),null!=c.mouseDownCallback&&c.mouseDownCallback()},onMouseUp:function(a){c.bMouseDown=!1;var b=c.getMouseScreenX(a),e=c.getMouseScreenY(a);c.xMouseScreenUp=b,c.yMouseScreenUp=e,c.tMouseScreenUp=d.getTimestamp(),null!=c.mouseUpCallback&&c.mouseUpCallback()},setup:function(){c.addMouseListeners()}};c.setup();var d={token:null,config:null,callbackReady:null,callbackState:null,callbackIdPath:null,apiReady:!1,isApiReady:function(){return!!d.apiReady},getConfig:function(a){var b=d.getObjectProperty(d.config,a);return b},setConfig:function(a,b){window.postMessage({target:"xLabs",token:d.token,config:{path:a,value:b}},"*")},setToken:function(a){d.token=a,window.postMessage({target:"xLabs",token:d.token,config:null},"*")},getObjectProperty:function(a,b){if(void 0==a||null==a)return"";for(var c=b.split("."),d=c.pop(),e=c.length,f=1,g=c[0];(a=a[g])&&e>f;)g=c[f],f++;return a?a[d]:void 0},t1:0,resetCalibrationTruth:function(){d.t1=0},updateCalibrationTruth:function(a,b){var c=d.t1,e=d.getTimestamp();0>=c&&(c=e,e+=1),d.addCalibrationTruth(c,e,a,b),d.t1=e},addCalibrationTruth:function(a,b,c,e){var f=a+","+b+","+parseInt(c)+","+parseInt(e);d.setConfig("truth.append",f)},calibrate:function(a){var b="3p";a&&(b=a),d.setConfig("calibration.request",b),console.log("xLabs: Calibrating...")},calibrationClear:function(){d.setConfig("calibration.clear",request),console.log("xLabs: Clearing calibration...")},getTimestamp:function(){var a=new Date,b=a.getTime();return b},getDpi:function(){var a=window.devicePixelRatio||(window.matchMedia&&window.matchMedia("(min-resolution: 2dppx), (-webkit-min-device-pixel-ratio: 1.5),(-moz-min-device-pixel-ratio: 1.5),(min-device-pixel-ratio: 1.5)").matches?2:1)||1,b=screen.width*a,c=screen.height*a;return this.calcDpi(b,c,13.3,"d")},calcDpi:function(a,b,c,d){a>0||(a=1),b>0||(b=1),d||(d="d");var e=("d"==d?Math.sqrt(a*a+b*b):"w"==d?a:b)/c;return e>0?Math.round(e):0},devicePixelRatio:function(){var a=parseFloat(d.getConfig("browser.screen.devicePixelRatioWithoutZoom"));if(!a)return null;var a=parseInt(a);return 0===a?null:window.devicePixelRatio/a},documentOffset:function(){if(!d.documentOffsetReady())throw"xLabs: Should not call scr2doc() unless mouse moved, i.e. browser.document.offset.ready == 1";var a=parseInt(d.getConfig("browser.document.offset.x")),b=parseInt(d.getConfig("browser.document.offset.y"));return{x:a,y:b}},documentOffsetReady:function(){var a=d.getConfig("browser.document.offset.ready");return 0!=a.localeCompare("1")?!1:!0},scr2docX:function(a){if(!d.documentOffsetReady())throw"xLabs: Should not call scr2doc() unless mouse moved, i.e. browser.document.offset.ready == 1";var b=parseInt(d.getConfig("browser.document.offset.x"));return a-window.screenX-b},scr2docY:function(a){if(!d.documentOffsetReady())throw"xLabs: Should not call scr2doc() unless mouse moved, i.e. browser.document.offset.ready == 1";var b=parseInt(d.getConfig("browser.document.offset.y"));return a-window.screenY-b},scr2doc:function(a,b){return{x:d.scr2docX(a),y:d.scr2docY(b)}},doc2scrX:function(a){if(!d.documentOffsetReady())throw"xLabs: Should not call scr2doc() unless mouse moved, i.e. browser.document.offset.ready == 1";var b=parseInt(d.getConfig("browser.document.offset.x"));return a+window.screenX+b},doc2scrY:function(a){if(!d.documentOffsetReady())throw"xLabs: Should not call scr2doc() unless mouse moved, i.e. browser.document.offset.ready == 1";var b=parseInt(d.getConfig("browser.document.offset.y"));return a+window.screenY+b},doc2scr:function(a,b){return{x:d.doc2scrX(a),y:d.doc2scrY(b)}},onApiReady:function(){d.apiReady=!0,null!=d.callbackReady&&d.callbackReady()},onApiState:function(a){d.config=a,null!=d.callbackState&&d.callbackState()},onApiIdPath:function(a){null!=d.callbackIdPath&&d.callbackIdPath(a.id,a.path)},extensionVersion:function(){return document.documentElement.getAttribute("data-xlabs-extension-version")},setup:function(a,b,c){return d.extensionVersion()?(d.callbackReady=a,d.callbackState=b,d.callbackIdPath=c,void(d.apiReady&&d.callbackReady())):void alert("xLabs chrome extension is not installed")}};document.addEventListener("xLabsApiReady",function(){d.onApiReady()}),document.addEventListener("xLabsApiState",function(a){d.onApiState(a.detail)}),document.addEventListener("xLabsApiIdPath",function(a){d.onApiIdPath(a.detail)});var e={DEBUG:!1,Session_Key_Route:SERVER_HOST+"/key/session",Participant_Key_Route:SERVER_HOST+"/key/participant",DataDeliverRoute:SERVER_HOST+"/data",api_token:"",session_key_name:"session_key",participant_key_name:"participant_key",sdk_config:null,data_index:0,data_array:[],data_counter:100,domain:null,url:null,participant_key:null,session_key:null,start:function(){"use strict";d.setConfig("system.mode","learning"),e.domain=document.domain,e.url=window.location.href,e.requestParticipantKey(),e.requestSessionKey(),e.session_key=window.sessionStorage[e.session_key_name],e.participant_key=window.localStorage[e.participant_key_name],console.log(e.session_key)},update:function(){"use strict";var a=parseInt(d.getConfig("state.trackingSuspended"));parseInt(d.getConfig("calibration.status"));if(null!==d.config&&1!=a){e.sdk_config=d.config;var b=k.getElement(e.sdk_config.state.gaze.measured.x,e.sdk_config.state.gaze.measured.y);e.sdk_config.tags=k.retrieveAllTags(b),e.sdk_config.dataIndex=e.data_index,e.data_index++,console.log("data_index : "+e.sdk_config.dataIndex),console.log(e.sdk_config);var c=e.packingData();0===e.data_counter&&(e.sendData(c),e.data_array=[],e.data_counter=100)}},build_json:function(a){"use strict";var b={},c={};if(null!=a){b.timestamp=a.state.timestamp,b.calibrationStatus=a.calibration.status,b.confidence=a.state.calibration.confidence,b.data_index=e.data_index,e.data_index++,c.x=a.state.gaze.measured.x,c.y=a.state.gaze.measured.y,b.gaze=c,b.browser_screen=a.browser.screen;var d=document.elementFromPoint(c.x,c.y);return null!==d?b.tags=k.retrieveAllTags(d):b.element="Nil",b}},packingData:function(){"use strict";if(!(e.data_counter>0&&(e.data_array.push(e.sdk_config),e.data_counter--,e.data_counter>0))){var a={};a.config=e.data_array;var b=e.compressData(a);return e.DEBUG&&(e.showCompressionRate(a),e.DEBUG=!1),b}},compressData:function(a){"use strict";var c=b.compressToEncodedURIComponent(JSON.stringify(a));return c},decompressData:function(a){"use strict";var c=b.decompressFromEncodedURIComponent(a);return c},showCompressionRate:function(b){"use strict";var c=document.createElement("span"),d=document.createElement("br");console.time("compression");var f=e.compressData(b);console.timeEnd("compression"),console.time("decompression");var g=JSON.stringify(JSON.parse(e.decompressData(f)));console.timeEnd("decompression");var h=a(f)/a(JSON.stringify(b))*100,i=document.createTextNode("Size of Json object: "+a(b)+" Size before compress: "+a(JSON.stringify(b))+" Compressed size: "+a(f)+" Decompressed size: "+a(g)+" Compression rate: "+h.toFixed(2)+"%");c.appendChild(i),c.appendChild(d),document.body.appendChild(c)},sendData:function(a){"use strict";var b={};b.data=a,b.domain=e.domain,b.url=e.url,b.session_key=e.session_key,b.participant_key=e.participant_key,console.log("data delivered :"),console.dir(b),$.ajax({url:e.DataDeliverRoute,datatype:"json",contentType:"application/json; charset=utf-8",processData:!1,type:"POST",crossDomain:!0,data:JSON.stringify(b)}).done(function(a){console.log("---------- /data api response -----------"),console.log(a)}).error(function(a){console.log(a.responseText)}).fail(function(){console.log("Error")})},onXlabsReady:function(){"use strict";d.setConfig("calibration.clear","1"),d.setToken(e.api_token),e.start()},onXlabsState:function(){"use strict";e.update()},requestParticipantKey:function(){"use strict";window.localStorage[e.participant_key_name]||$.ajax({url:e.Participant_Key_Route,type:"GET",crossDomain:!0}).done(function(a){window.localStorage[e.participant_key_name]=a.participant_key,e.participant_key=window.localStorage[e.participant_key_name],console.log("Refresh participant key: "+a.participant_key)}).fail(function(){console.log("Fail to update participant key")})},requestSessionKey:function(){"use strict";window.sessionStorage[e.session_key_name]||$.ajax({url:e.Session_Key_Route,type:"GET",crossDomain:!0}).done(function(a){window.sessionStorage[e.session_key_name]=a.session_key,e.session_key=window.sessionStorage[e.session_key_name],console.log(a.session_key)}).fail(function(){console.log("Fail to update session key")})},setup:function(){"use strict";window.addEventListener("beforeunload",function(){d.setConfig("system.mode","off")}),d.setup(e.onXlabsReady,e.onXlabsState)}};"undefined"!=typeof exports&&(exports.embeddedJS=e);var f={componentPosition:{},start:function(){"use strict";f.frontEndSupport(),parent.window.postMessage("ready","*")},frontEndSupport:function(){"use strict";window.addEventListener("message",function(a){a.origin.includes(FRONT_END_HOST)&&f.messageHandler(a)},!1)},messageHandler:function(a){var b=$("["+k.attr_xa_track+"]");if("location"==a.data){var c=window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft,d=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop;b.each(function(a,b){var e=k.retrieveTag(b).name;f.componentPosition[e]={},f.componentPosition[e].left=b.getBoundingClientRect().left+c,f.componentPosition[e].top=b.getBoundingClientRect().top+d,f.componentPosition[e].width=b.getBoundingClientRect().width,f.componentPosition[e].height=b.getBoundingClientRect().height}),console.log(f.componentPosition);var e=$(document).height();$("body").append("<div id='xa-overlay'></div>"),$("#xa-overlay").height(e).css({opacity:0,position:"absolute",top:0,left:0,width:"100%","z-index":5e3}),a.source.postMessage(f.componentPosition,"*")}else{console.log(a.data);var g=a.data;for(componentName in g)f.createOverlay(f.componentPosition[componentName],componentName,g[componentName]);$(".xa-view .xa-mask").on("click","a",function(b){var c=$(this).attr("data-overlay-name");a.source.postMessage(c,"*")})}},createOverlay:function(a,b,c){"use strict";var d=document.createElement("div");$(d).height(a.height),$(d).width(a.width),$(d).offset({top:a.top,left:a.left}),d.style.position="absolute",d.style.opacity="0.8",d.style.zIndex=9998,d.style.display="block";var e=$("#component-overlay").clone();e.find(".xa-mask h1").text(b),e.find(".xa-mask h1").after("<p style=\"font-family: 'Arial'; font-size: 15px; font-style:none;\">session time: "+c.sessionTime+"</p>"),e.find(".xa-mask h1").after("<p style=\"font-family: 'Arial'; font-size: 15px; font-style:none;\">fixation number: "+c.fixationNumber+"</p>"),e.find(".xa-mask a").attr("data-overlay-name",b),$(d).append(e.html()),$("body").append(d)}},g={DEBUG:!1,MouseClickRoute:SERVER_HOST+"/clicks",click_data:null,data_array:[],number_data:100,data_counter:null,domain:null,url:null,session_key:null,participant_key:null,start:function(){"use strict";g.data_counter=g.number_data,g.domain=document.domain,g.url=window.location.href,c.mouseUpCallback=g.onMouseUp,window.addEventListener("beforeunload",function(a){g.onDataReady()})},onMouseUp:function(){"use strict";var a=c.xMouseScreen,b=c.yMouseScreen,e=d.scr2doc(a,b);g.DEBUG&&(console.log("click@screen "+a+","+b),console.log("click@ "+e.x+","+e.y)),g.click_data=g.build_json(d.config,e),g.packData(g.onDataCollecting,g.onDataReady)},packData:function(a,b){"use strict";g.data_counter>0&&(a(),g.data_counter--,g.data_counter>0)||b()},onDataReady:function(){"use strict";g.session_key=window.sessionStorage[e.session_key_name],g.participant_key=window.localStorage[e.participant_key_name];var a={};a.domain=g.domain,a.url=g.url,a.session_key=g.session_key,a.participant_key=g.participant_key,a.clicks=g.data_array,1==g.DEBUG&&(console.log("Mouse click data sent : ---------"),console.log(a),console.log("-----------------------")),g.sendData(a),g.resetDataArray()},onDataCollecting:function(){"use strict";g.data_array.push(g.click_data)},resetDataArray:function(){"use strict";g.data_array=[],g.data_counter=g.number_data},sendData:function(a){"use strict";console.log("-----Mouse Click event data :-----"),console.dir(a),$.ajax({url:g.MouseClickRoute,datatype:"json",contentType:"application/json; charset=utf-8",processData:!1,type:"POST",crossDomain:!0,data:JSON.stringify(a)}).done(function(a){console.log("---------- /clicks api response ----------"),console.log(JSON.stringify(a))}).fail(function(){console.error("Error in sending mouse clicking data.")})},build_json:function(a,b){"use strict";var c={};if(null!==a){c.timestamp=a.state.timestamp,c.data_index=e.data_index;var d=k.getElement(b.x,b.y);return c.tags=k.retrieveAllTags(d),c.x=b.x,c.y=b.y,c}}},h="asked",i="accept",j={text:'Do you want to continue with Eye Gaze Tracking? <a class="xa_href" href=".">Term & Conditions</a>',onAccept:null,onReject:null,openPermissionForm:function(a,b){"use strict";j.onAccept=a,j.onReject=b,j.openPermission(j.isAsked(),j.onAccept,j.onReject)},openPermission:function(a,b,c){"use strict";a||j.generateWarning(j.text)},isExtensionInstalled:function(){"use strict";var a=d.extensionVersion();return console.log(a?"Extension is installed.":"Extension is not installed yet."),a},isAsked:function(){"use strict";return localStorage[h]?!0:!1},isAccepted:function(){"use strict";var a="1"===localStorage[i],b=a?"accepted":"rejected";return console.log(" User has "+b+" to open extension "),a},generateWarning:function(a){"use strict";var b=a+'<button id="xa_cancel_button" >Cancel</button><button id="xa_confirm_button" >Confirm</button>',c=document.createElement("div");c.id="xa_warning",c.innerHTML='<div class="xa_warning_content"><b>'+b+"</b></div>",document.getElementsByTagName("body")[0]&&document.getElementsByTagName("body")[0].appendChild(c);var d=document.createElement("style");d.type="text/css",d.innerHTML="div#xa_warning {position: absolute; top: 0; left: 0; right: 0; padding: 10px 10px; opacity: 0.85; background-color: #DDEEEE; -webkit-box-shadow: 0 0 5px black; -moz-box-shadow: 0 0 5px black; box-shadow: 0 0 5px black;} .xa_warning_content {width: 100%;  } #xa_confirm_button, #xa_cancel_button { margin-left: 5px; float: right; color: white; font-size: 14px; padding: 5px; border-radius: 4px; text-shadow: 0 1px 1px rgba(0, 0, 0, 0, 0.2) }  #xa_confirm_button { background: rgb(28, 184, 65);} #xa_cancel_button {background: rgb(202, 60, 60);}",document.getElementsByTagName("head")[0].appendChild(d),document.getElementById("xa_cancel_button").addEventListener("click",function(){j.onPermissionReject()}),document.getElementById("xa_confirm_button").addEventListener("click",function(){j.onPermissionAccept()})},onPermissionAccept:function(){"use strict";j.removeWarning("xa_warning"),localStorage[h]="1",localStorage[i]="1",null!=j.onAccept&&j.onAccept()},onPermissionReject:function(){"use strict";j.removeWarning("xa_warning"),localStorage[h]="1",localStorage[i]="0",null!=j.onReject&&j.onReject()},removeWarning:function(a){"use strict";var b=document.getElementsByTagName("body")[0],c=document.getElementById(a);b.removeChild(c)}},k={DEBUG:!1,attr_xa_track:"xa_track",attr_xa_sub_track:"xa_sub_track",getElement:function(a,b){"use strict";return document.elementFromPoint(a,b)},retrieveAllTags:function(a){"use strict";var b=[];if(null==a)return b;var c=a.getAttribute(k.attr_xa_track);return null!=c&&b.push(k.parse(c)),$(a).parents("["+k.attr_xa_track+"]").each(function(){var a=$(this).attr(k.attr_xa_track),c=$(this).attr(k.attr_xa_sub_track);null!=a&&b.push({tag:k.parse(a),sub_tag:k.parse(c)})}),b.length>0&&k.DEBUG===!0&&console.log(b),b},retrieveTag:function(a){"use strict";if(null===a)return"";var b=$(a).closest("["+k.attr_xa_track+"]");return k.DEBUG===!0&&console.log(b.attr(k.attr_xa_track)),k.parse(a.getAttribute(k.attr_xa_track))||k.parse(b.attr(k.attr_xa_track))},retrieveTagName:function(a){"use strict";var b=a.match(/^name:\s*\w+/i),c=b?String(b).split(":")[1].trim():null;return c},retrieveTagClass:function(a){"use strict";var b=a.match(/classes:\s*[ \w+]*/i),c=b?String(b).split(":")[1].trim():null;return k.DEBUG===!0&&console.log("Classes: "+(c?c.split(" "):null)),c?c.split(" "):null},isValid:function(a){"use strict";try{var b=a.search(/^name:\s*\w+;(classes:)*[ \w+]*/i);if(-1===b)throw'tag "'+a+'" is in invalid format'}catch(c){return console.error("Error: "+c+"."),!1}return!0},anyRepeatTag:function(){"use strict";var a=k.findAllTags(),b=[];if(null==a)return!1;a=k.sort_tags(a);for(var c=0,d=a.length;d>c;c++){var e=k.retrieveTagName(a[c]||""),f=k.retrieveTagName(a[c+1]||"");null!=e&&null!=f&&e==f&&jQuery.inArray(e,b)<=-1&&b.push(e)}return b.length>0?b:!1},sort_tags:function(a){"use strict";var a=a.sort(function(a,b){return k.retrieveTagName(a)>k.retrieveTagName(b)});return a},findAllTags:function(){"use strict";var a=[];return $(document).find("["+k.attr_xa_track+"]").each(function(){a.push($(this).attr(k.attr_xa_track))}),a},parse:function(a){"use strict";if(null==a||!k.isValid(a))return null;var b={},c=k.retrieveTagName(a),d=k.retrieveTagClass(a);return b.name=c,b.classes=d,b}};ROOTURL="//"+window.location.host;var h="asked",i="accept",l=(localStorage[h]||"0",{set_config:function(a,b){"use strict";a&&(SERVER_HOST=a),b&&(FRONT_END_HOST=b)},start:function(a){"use strict";e.api_token=a||"32eMr5NuNzaxqwUs8",window.onload=function(){return window.jQuery?(f.start(),void(l.isExtensionInstalled()&&(j.openPermissionForm(l.onPermissionAccept,l.onPermissionReject),j.isAsked()&&j.isAccepted()&&(e.setup(),g.start())))):void console.error("jQuery didn't loaded properly.")}},onPermissionAccept:function(){"use strict";console.log("Accept click"),e.setup()},onPermissionReject:function(){"use strict"},isExtensionInstalled:function(){"use strict";return j.isExtensionInstalled()}});return l}();"function"==typeof define&&define.amd?define(function(){return xa}):"undefined"!=typeof module&&null!=module&&(module.exports=xa);